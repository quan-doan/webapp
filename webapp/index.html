<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"/>
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
        <title>Wireless</title>
        <link rel="stylesheet"type="text/css"href="base.css"/>
    </head>
    <body>
        <div id="screen">
            <header id="nav">
                <ul>
                    <li>
                        <a class="active" href="javascript:" title="Post it" rel="0"><span class="icon ico-post"></span><span class="text">Post it</span></a>
                    </li>
                    <li>
                        <a href="javascript:" title="Calendar" rel="1"><span class="icon ico-calendar"></span><span class="text">Calendar</span></a>
                    </li>
                    <li>
                        <a href="javascript:" title="Address" rel="2"><span class="icon ico-address"></span><span class="text">Address</span></a>
                    </li>
                    <li>
                        <a href="javascript:" title="Map" rel="3"><span class="icon ico-map"></span><span class="text">Map</span></a>
                    </li>
                </ul>
            </header>
            <div id="pagewrapper">
                <div id="pageflip">
                    <div class="scrollerwrapper">
                        <div class="scroller">
                            <ul>
                                <li>
                                    <a href="http://xiaoqiang.org/demo/webapp/index.html">reload</a>
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                                <li>
                                    Contact Name1
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="scrollerwrapper">
                        <div class="scroller">
                            <ul>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                                <li>
                                    Contact Name2
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="scrollerwrapper">
                        <div class="scroller">
                            <ul>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                                <li>
                                    Contact Name3
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="scrollerwrapper">
                        <div class="scroller">
                            <ul>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                                <li>
                                    Contact Name4
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="iscroll.js?v=4.0">
        </script>
        <script>
            var WebApp = function(){
                var page_flip, vertical_scroll = [], pages, t, p, $id = function(id){
                    return document.getElementById(id);
                }, $sa = function(s){
                    return document.querySelectorAll(s);
                }, $s = function(s){
                    return document.querySelector(s);
                }, initScroll = function(){//初始化iscroll
                    if (window.scrollY != 1) {
                        t = setTimeout(initScroll, 100);
                    }
                    else {
                        clearTimeout(t);
                        t = null;
                        $id('pagewrapper').style.height = window.innerHeight + 'px';
                        pages = $sa('.scrollerwrapper');
                        page_flip = new iScroll('pagewrapper', {
                            bounce: false,
                            hScrollbar: false,
                            vScrollbar: false,
                            snap: true,
                            momentum: false,
                            onScrollEnd: function(){
                                $s('#nav > ul > li > a.active').className = '';
                                $s('#nav > ul > li:nth-child(' + (this.currPageX + 1) + ') a').className = 'active';
                            }
                        });
                        setSize();
                        for (var a = 0; a < pages.length; a++) {
                            vertical_scroll[a] = new iScroll(pages[a], {
                                bounce: false,
                                hScrollbar: false,
                                vScrollbar: true
                            });
                        }
                        window.addEventListener('onorientationchange' in window ? 'orientationchange' : 'resize', function(){
                            setSize();
                            setTimeout(function(){
                                var a = page_flip.currPageX;
                                page_flip.scrollToPage(a, 0, 0)
                            }, 400);
                        }, false);
                        delegate('nav', 'touchstart', goToPage);
                        document.addEventListener('touchmove', stopDefault, false);
                        page_flip.refresh();
                    }
                }, setSize = function(){//重新计算宽度
                    if (window.scrollY != 1) {
                        window.scrollTo(0, 1);
                        p =  setTimeout(setSize, 100);
                    }
                    else {
                        clearTimeout(p);
                        p = null;
                        $id('pagewrapper').style.height = window.innerHeight + 'px';
                        page_flip.refresh();
                        var e = $id('pagewrapper'), a = $id('pageflip'), b = e.offsetWidth;
                        a.style.width = b * 4 + 'px';
                        for (var c = 0; c < pages.length; c++) {
                            pages[c].style.width = b + 'px'
                        }
                    }
                    
                }, loaded = function(){//初始化load事件
                    window.scrollTo(0, 1);
                    t = setTimeout(initScroll, 100);
                    window.removeEventListener('load', loaded, false);
                }, stopDefault = function(e){
                    e.preventDefault()
                }, delegate = function(obj, fun, callback){
                    var parent = $id(obj);
                    parent.addEventListener(fun, callback, false);
                }, goToPage = function(e){
                    try {
                        var a = e.target;
                        if (a.nodeName.toLowerCase() === 'a' || a.nodeName.toLowerCase() === 'span') {
                            var n = a.nodeName.toLowerCase() === 'a' ? +a.getAttribute('rel') : +a.parentNode.getAttribute('rel');
                            stopDefault(e);
                            page_flip.scrollToPage(n, 0, 400);
                        }
                    } 
                    catch (e) {
                        console.log(e);
                    }
                }, init = function(){
                    window.addEventListener('load', loaded, false);
                }
                return {
                    _init: function(){
                        init();
                    }
                }
            }, wa = new WebApp();
            wa._init();
        </script>
    </body>
</html>
